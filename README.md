mostly based on stm32f407
